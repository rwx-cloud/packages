name: rwx/install-abq
version: 1.1.7
description: ABQ is a universal test runner that runs test suites in parallel. Itâ€™s the best tool for splitting test suites into parallel jobs in CI.
source_code_url: https://github.com/rwx-cloud/packages/tree/main/rwx/install-abq
issue_tracker_url: https://github.com/rwx-cloud/packages/issues

parameters:
  rwx-access-token:
    description: "This parameter is deprecated and you do not need to pass it."
    required: false

tasks:
  - key: install
    run: |
      install_id=rwx-$(date +%F)
      tmp="$(mktemp -d)"
      curl -o "$tmp/abq" -fsSL \
        -H "Authorization: Bearer $RWX_ACCESS_TOKEN" \
        "https://cloud.rwx.com/abq/api/releases/v1/Linux/$(uname -p)/abq?install_id=${install_id}"
      sudo install "$tmp/abq" /usr/local/bin
      rm -rf $tmp
      abq --version
    cache:
      enabled: true
      ttl: 1 day
